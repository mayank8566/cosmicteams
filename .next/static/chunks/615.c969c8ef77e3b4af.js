"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[615],{4615:(e,t,a)=>{a.r(t),a.d(t,{default:()=>u});var s=a(5155),i=a(2115),r=a(6874),l=a.n(r),n=a(5695),o=a(5928),c=a(6493),d=a(8596),h=a(5317),m=a(6104);function u(){var e,t;let a=(0,n.usePathname)(),r=(0,n.useRouter)(),{user:u,logout:p}=(0,o.A)(),{profile:x}=(0,c.x)(),[f,w]=(0,i.useState)(!1),[v,g]=(0,i.useState)(!1),[j,k]=(0,i.useState)(!1),b=(0,i.useRef)(null);(0,i.useEffect)(()=>{let e=()=>{w(window.scrollY>20)};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[]),(0,i.useEffect)(()=>{let e=e=>{b.current&&!b.current.contains(e.target)&&g(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,i.useEffect)(()=>{(async()=>{if(u)try{let e=await (0,h.x7)((0,h.H9)(m.db,"users",u.email));if(e.exists()){let t=e.data();k("admin"===t.role)}}catch(e){}})()},[u]);let y=async()=>{try{await p(),r.push("/")}catch(e){}};return(0,s.jsx)("header",{className:"w-full py-4 px-6 backdrop-blur-md sticky top-0 z-50 transition-all duration-300 ".concat(f?"bg-space-dark/90 shadow-lg":"bg-space-dark/80 border-b border-space-purple/20"),children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto flex justify-between items-center",children:[(0,s.jsx)(l(),{href:"/",className:"flex items-center link-prefetch",children:(0,s.jsxs)("div",{className:"font-space font-bold text-xl",children:[(0,s.jsx)("span",{className:"text-white",children:"COSMIC"}),(0,s.jsx)("span",{className:"text-space-purple cosmic-glow ml-1",children:"TEAMS"})]})}),(0,s.jsxs)("nav",{className:"hidden md:flex items-center space-x-6",children:[(0,s.jsx)(l(),{href:"/",className:"font-medium transition-colors duration-200 hover:text-space-cyan link-prefetch ".concat("/"===a?"text-space-cyan":"text-white/80"),children:"Home"}),(0,s.jsx)(l(),{href:"/about",className:"font-medium transition-colors duration-200 hover:text-space-cyan link-prefetch ".concat("/about"===a?"text-space-cyan":"text-white/80"),children:"About"}),(0,s.jsx)(l(),{href:"/features",className:"font-medium transition-colors duration-200 hover:text-space-cyan link-prefetch ".concat("/features"===a?"text-space-cyan":"text-white/80"),children:"Features"}),(0,s.jsx)(l(),{href:"/marketplace",className:"font-medium transition-colors duration-200 hover:text-space-cyan link-prefetch ".concat("/marketplace"===a?"text-space-cyan":"text-white/80"),children:"MarketPlace"}),(0,s.jsx)(l(),{href:"/tier",className:"font-medium transition-colors duration-200 hover:text-space-cyan link-prefetch ".concat("/tier"===a?"text-space-cyan":"text-white/80"),children:"Game Tiers"})]}),(0,s.jsx)("div",{className:"flex items-center space-x-4",children:u?(0,s.jsxs)("div",{className:"relative",ref:b,children:[(0,s.jsxs)("button",{onClick:()=>g(!v),className:"flex items-center space-x-3 py-1 px-2 rounded-lg hover:bg-space-blue/30 transition-colors duration-200",children:[(0,s.jsx)("div",{className:"w-9 h-9 rounded-full overflow-hidden border-2 border-space-purple/50",children:(null==x?void 0:x.photoURL)?(0,s.jsx)(d.A,{src:x.photoURL,alt:"Profile",width:36,height:36,className:"object-cover w-full h-full",fallbackSrc:"/images/default-avatar.svg",priority:!0}):(0,s.jsx)("div",{className:"w-full h-full flex items-center justify-center bg-space-indigo text-white font-bold text-lg",children:(null==x?void 0:x.displayName)?x.displayName.charAt(0).toUpperCase():(null==u?void 0:null===(t=u.email)||void 0===t?void 0:t.charAt(0).toUpperCase())||"U"})}),(0,s.jsx)("span",{className:"hidden md:inline-block font-medium text-white",children:(null==x?void 0:x.displayName)||(null===(e=u.email)||void 0===e?void 0:e.split("@")[0])||"User"}),(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-white/70",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),v&&(0,s.jsxs)("div",{className:"absolute right-0 mt-2 w-56 bg-space-blue/90 backdrop-blur-md border border-space-purple/30 rounded-lg shadow-xl py-2 z-50 animate-fade-in-up",style:{animationDuration:"0.2s"},children:[(0,s.jsxs)("div",{className:"px-4 py-2 border-b border-space-purple/20",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-white",children:(null==x?void 0:x.displayName)||"User"}),(0,s.jsx)("p",{className:"text-xs text-white/60 truncate",children:null==x?void 0:x.email})]}),(0,s.jsx)(l(),{href:"/profile",className:"block px-4 py-2 text-sm text-white hover:bg-space-indigo/30 transition-colors",onClick:()=>g(!1),children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),(0,s.jsx)("span",{children:"Edit Profile"})]})}),(0,s.jsx)(l(),{href:"/dashboard",className:"block px-4 py-2 text-sm text-white hover:bg-space-indigo/30 transition-colors",onClick:()=>g(!1),children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})}),(0,s.jsx)("span",{children:"Dashboard"})]})}),(0,s.jsx)(l(),{href:"/tier",className:"block px-4 py-2 text-sm text-white hover:bg-space-indigo/30 transition-colors",onClick:()=>g(!1),children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),(0,s.jsx)("span",{children:"Game Tiers"})]})}),(0,s.jsx)(l(),{href:"/settings",className:"block px-4 py-2 text-sm text-white hover:bg-space-indigo/30 transition-colors",onClick:()=>g(!1),children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a9 9 0 11-18 0 9 9 0 0118 0z"})]}),(0,s.jsx)("span",{children:"Settings"})]})}),(0,s.jsx)(l(),{href:"/mail",className:"block px-4 py-2 text-sm text-white hover:bg-space-indigo/30 transition-colors",onClick:()=>g(!1),children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),(0,s.jsx)("span",{children:"Mail"})]})}),j&&(0,s.jsx)(l(),{href:"/admin/token-management",className:"block px-4 py-2 text-sm text-space-gold hover:bg-space-indigo/30 transition-colors",onClick:()=>g(!1),children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,s.jsx)("span",{children:"Admin: Token Management"})]})}),(0,s.jsx)("div",{className:"border-t border-space-purple/20 my-1"}),(0,s.jsx)("button",{onClick:y,className:"w-full text-left px-4 py-2 text-sm text-white hover:bg-space-pink/30 transition-colors",children:(0,s.jsxs)("div",{className:"flex items-center text-space-pink",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),(0,s.jsx)("span",{children:"Sign out"})]})})]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l(),{href:"/login",className:"btn-gradient-secondary text-sm link-prefetch",children:(0,s.jsx)("span",{children:"Login"})}),(0,s.jsx)(l(),{href:"/register",className:"btn-gradient text-sm hidden md:inline-block link-prefetch",children:"Sign Up"})]})})]})})}},5695:(e,t,a)=>{var s=a(8999);a.o(s,"usePathname")&&a.d(t,{usePathname:function(){return s.usePathname}}),a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}})},6493:(e,t,a)=>{a.d(t,{H:()=>m,x:()=>h});var s=a(5155),i=a(2115),r=a(5317),l=a(3004),n=a(858),o=a(6104),c=a(5928);let d=(0,i.createContext)(null);function h(){let e=(0,i.useContext)(d);if(!e)throw Error("useProfile must be used within a ProfileProvider");return e}function m(e){let{children:t}=e,{user:a}=(0,c.A)(),[h,m]=(0,i.useState)(null),[u,p]=(0,i.useState)(!0),[x,f]=(0,i.useState)(!1),[w,v]=(0,i.useState)(null);(0,i.useEffect)(()=>{!async function(){if(!a){m(null),p(!1);return}p(!0);try{let e={displayName:a.displayName||"",photoURL:a.photoURL||"",email:a.email||"",username:a.email?a.email.split("@")[0]:"",profileMusic:null,musicType:null,gameTiers:{"neth-op":"LT1",axe:"LT1",smp:"LT1",cpvp:"LT1",sword:"LT1",uhc:"LT1"},canCreateTeams:!0,lastUpdated:Date.now(),createdAt:Date.now(),cosmicTokens:100,spinnerUsed:0,lastSpinTime:0};if(a.uid&&o.db){let t=(0,r.H9)(o.db,"userProfiles",a.uid),s=await (0,r.x7)(t);s.exists()?m({...e,...s.data()}):(await (0,r.BN)(t,{...e,createdAt:Date.now(),lastUpdated:Date.now()}),m(e))}else m(e)}catch(e){v("Failed to load profile data"),a&&m({displayName:a.displayName||"",photoURL:a.photoURL||"",email:a.email||"",username:a.email?a.email.split("@")[0]:"",profileMusic:null,musicType:null})}finally{p(!1)}}()},[a,o.db]);let g=async e=>{if(a){f(!0),v(null);try{if(e.displayName||e.photoURL){let t={};e.displayName&&(t.displayName=e.displayName),e.photoURL&&(t.photoURL=e.photoURL),await (0,l.r7)(a,t)}if(void 0!==e.cosmicTokens){if(e.cosmicTokens<0)throw Error("Token amount cannot be negative");e.cosmicTokens=Number(e.cosmicTokens)}if(a.uid&&o.db){let t=(0,r.H9)(o.db,"userProfiles",a.uid),s={...e,lastUpdated:Date.now()};await (0,r.mZ)(t,s);let i=(await (0,r.x7)(t)).data();m(e=>e?{...e,...i}:null)}else m(t=>t?{...t,...e}:null)}catch(e){throw v("Failed to update profile"),e}finally{f(!1)}}},j=async e=>{if(!a)throw Error("User not authenticated");f(!0),v(null);try{if(e.size>2097152)throw Error("Image file is too large. Please select a file under 2MB.");if(!e.type.startsWith("image/"))throw Error("Please select a valid image file (JPG, PNG, etc.)");let t=(0,n.KR)(o.IG,"profile-images/".concat(a.uid,"/").concat(Date.now(),"-").concat(e.name));if((null==h?void 0:h.photoURL)&&h.photoURL.includes("firebasestorage.googleapis.com"))try{let e=(0,n.KR)(o.IG,h.photoURL);await (0,n.XR)(e)}catch(e){}await (0,n.D)(t,e);let s=await (0,n.qk)(t);return await g({photoURL:s}),s}catch(e){throw v(e instanceof Error?e.message:"Failed to upload profile image"),e}finally{f(!1)}},k=async e=>{if(a){f(!0),v(null);try{a.uid&&await g({gameTiers:e})}catch(e){throw v("Failed to update game tiers"),e}finally{f(!1)}}},b=async(e,t)=>{if(!a||!a.email)throw Error("User not authenticated or email not available");f(!0),v(null);try{let s=l.IX.credential(a.email,e);await (0,l.kZ)(a,s),await (0,l.f3)(a,t)}catch(e){throw"auth/wrong-password"===e.code?v("Current password is incorrect"):v("Failed to change password"),e}finally{f(!1)}},y=async(e,t)=>{if(!a||!a.email)throw Error("User not authenticated or email not available");f(!0),v(null);try{let s=l.IX.credential(a.email,e);await (0,l.kZ)(a,s),await (0,l.Ww)(a,t),await g({email:t})}catch(e){throw"auth/wrong-password"===e.code?v("Current password is incorrect"):"auth/email-already-in-use"===e.code?v("This email is already in use by another account"):v("Failed to change email"),e}finally{f(!1)}};return(0,s.jsx)(d.Provider,{value:{profile:h,loading:u,updating:x,error:w,updateProfileData:g,uploadProfileImage:j,changePassword:b,changeEmail:y,updateAllGameTiers:k},children:t})}},8596:(e,t,a)=>{a.d(t,{A:()=>l});var s=a(5155),i=a(2115),r=a(6766);function l(e){let{src:t,alt:a,fallbackSrc:l="/images/default-avatar.svg",...n}=e,[o,c]=(0,i.useState)(!1),[d,h]=(0,i.useState)(t),[m,u]=(0,i.useState)(!1);if((0,i.useEffect)(()=>{c(!0)},[]),(0,i.useEffect)(()=>{t&&(h(t),u(!1))},[t]),!d&&!m){if(!o)return(0,s.jsx)("div",{className:"bg-space-blue/50 ".concat(n.className||""),style:{width:n.width||"100%",height:n.height||"100%"},"aria-label":a||"Image placeholder"});u(!0),h(l)}return o?(0,s.jsx)(r.default,{...n,src:d||l,alt:a,onError:()=>{u(!0),h(l)},unoptimized:!0,"data-client-image":"true"}):(0,s.jsx)("div",{className:"bg-space-blue/50 ".concat(n.className||""),style:{width:n.width||"100%",height:n.height||"100%"},"aria-label":a||"Image placeholder","data-ssr-placeholder":"true"})}}}]);