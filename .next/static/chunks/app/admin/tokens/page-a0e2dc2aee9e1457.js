(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[525],{255:(e,s,t)=>{"use strict";function a(e){let{moduleIds:s}=e;return null}Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"PreloadChunks",{enumerable:!0,get:function(){return a}}),t(5155),t(7650),t(5744),t(589)},697:(e,s,t)=>{Promise.resolve().then(t.bind(t,2859))},1584:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});var a=t(5155);let n=(0,t(5028).default)(()=>Promise.all([t.e(766),t.e(874),t.e(615)]).then(t.bind(t,4615)),{loadableGenerated:{webpack:()=>[4615]},ssr:!1});function r(){return(0,a.jsx)(n,{})}},2146:(e,s,t)=>{"use strict";function a(e){let{reason:s,children:t}=e;return t}Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"BailoutToCSR",{enumerable:!0,get:function(){return a}}),t(5262)},2859:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>o});var a=t(5155),n=t(2115),r=t(5695),l=t(5928),i=t(1584),c=t(5317),d=t(6104);function o(){let e=(0,r.useRouter)(),{user:s}=(0,l.A)(),[t,o]=(0,n.useState)([]),[u,m]=(0,n.useState)(!0),[x,f]=(0,n.useState)(""),[h,p]=(0,n.useState)(!1),[b,j]=(0,n.useState)(null),[y,N]=(0,n.useState)(null),[v,g]=(0,n.useState)(100),[w,k]=(0,n.useState)(!1),[_,P]=(0,n.useState)(null);(0,n.useEffect)(()=>{if(!s){e.push("/login");return}(async()=>{try{if(!s.email)return;let e=(0,c.H9)(d.db,"users",s.email),t=await (0,c.x7)(e);t.exists()?t.data().isAdmin?(p(!0),S()):(j("Access denied. Admin privileges required."),m(!1)):(j("User data not found."),m(!1))}catch(e){j("Failed to verify admin status."),m(!1)}})()},[s,e]);let S=async()=>{try{m(!0);let e=(0,c.rJ)(d.db,"users"),s=await (0,c.GG)(e),t=[];s.forEach(e=>{let s=e.data();t.push({id:e.id,email:e.id,displayName:s.displayName,username:s.username,cosmicTokens:s.cosmicTokens||0,photoURL:s.photoURL})}),o(t)}catch(e){j("Failed to load users.")}finally{m(!1)}},T=async()=>{if(!x.trim()){S();return}try{m(!0);let e=(0,c.rJ)(d.db,"users"),s=(0,c.P)(e,(0,c._M)("email",">=",x),(0,c._M)("email","<=",x+"")),t=(0,c.P)(e,(0,c._M)("username",">=",x),(0,c._M)("username","<=",x+"")),[a,n]=await Promise.all([(0,c.GG)(s),(0,c.GG)(t)]),r=[],l=new Set;a.forEach(e=>{if(!l.has(e.id)){let s=e.data();r.push({id:e.id,email:e.id,displayName:s.displayName,username:s.username,cosmicTokens:s.cosmicTokens||0,photoURL:s.photoURL}),l.add(e.id)}}),n.forEach(e=>{if(!l.has(e.id)){let s=e.data();r.push({id:e.id,email:e.id,displayName:s.displayName,username:s.username,cosmicTokens:s.cosmicTokens||0,photoURL:s.photoURL}),l.add(e.id)}}),o(r)}catch(e){j("Failed to search users.")}finally{m(!1)}},A=async()=>{if(y&&!(v<=0)&&!w)try{k(!0),P(null);let e=(0,c.H9)(d.db,"users",y.id),s=await (0,c.x7)(e);if(s.exists()){let t=(s.data().cosmicTokens||0)+v;await (0,c.mZ)(e,{cosmicTokens:t}),o(e=>e.map(e=>e.id===y.id?{...e,cosmicTokens:t}:e)),y==y&&N({...y,cosmicTokens:t}),P({type:"success",text:"Successfully granted ".concat(v," Cosmic Tokens to ").concat(y.username||y.email,"!")})}else P({type:"error",text:"User not found in database."})}catch(e){P({type:"error",text:"Failed to grant tokens. Please try again."})}finally{k(!1)}};return u&&!h?(0,a.jsxs)("main",{className:"min-h-screen flex flex-col",children:[(0,a.jsx)(i.A,{}),(0,a.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,a.jsx)("div",{className:"animate-spin w-12 h-12 border-4 border-space-cyan border-t-transparent rounded-full"})})]}):b||!h?(0,a.jsxs)("main",{className:"min-h-screen flex flex-col",children:[(0,a.jsx)(i.A,{}),(0,a.jsx)("div",{className:"flex-1 p-6 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"cosmic-card p-8 max-w-md text-center",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-red-500 mb-4",children:"Access Denied"}),(0,a.jsx)("p",{className:"mb-6",children:b||"You do not have permission to access this page."}),(0,a.jsx)("button",{onClick:()=>e.push("/dashboard"),className:"btn-gradient",children:"Return to Dashboard"})]})})]}):(0,a.jsxs)("main",{className:"min-h-screen flex flex-col",children:[(0,a.jsx)(i.A,{}),(0,a.jsx)("div",{className:"flex-1 px-6 py-12 relative overflow-hidden",children:(0,a.jsxs)("div",{className:"container mx-auto max-w-6xl",children:[(0,a.jsx)("h1",{className:"text-4xl font-bold font-space mb-2 animate-fade-in-up",children:(0,a.jsx)("span",{className:"gradient-text cosmic-gradient",children:"Admin: Cosmic Tokens"})}),(0,a.jsx)("p",{className:"text-cosmic-text-secondary mb-8 animate-fade-in-up",style:{animationDelay:"100ms"},children:"Grant Cosmic Tokens to users from this admin panel"}),(0,a.jsx)("div",{className:"cosmic-card border border-space-indigo/30 p-6 mb-8",children:(0,a.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)("input",{type:"text",placeholder:"Search by username or email",value:x,onChange:e=>f(e.target.value),className:"w-full cosmic-input"})}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:T,className:"btn-gradient-secondary",children:"Search"}),(0,a.jsx)("button",{onClick:S,className:"btn-outline",children:"Reset"})]})]})}),y&&(0,a.jsxs)("div",{className:"cosmic-card border border-space-purple/30 p-6 mb-8",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-space-cyan mb-4",children:"Grant Tokens"}),(0,a.jsxs)("div",{className:"flex items-center gap-4 mb-6",children:[(0,a.jsx)("div",{className:"w-12 h-12 rounded-full overflow-hidden bg-space-dark",children:(0,a.jsx)("img",{src:y.photoURL||"/default-avatar.png",alt:y.displayName||"User",className:"w-full h-full object-cover"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-semibold text-lg",children:y.displayName||"User"}),(0,a.jsx)("div",{className:"text-sm text-cosmic-text-secondary",children:y.username?"@".concat(y.username):y.email}),(0,a.jsxs)("div",{className:"text-space-gold font-medium",children:["Current Balance: ",y.cosmicTokens||0," Tokens"]})]})]}),_&&(0,a.jsx)("div",{className:"mb-4 p-3 rounded-lg ".concat("success"===_.type?"bg-green-900/30 border border-green-500/50 text-green-300":"bg-red-900/30 border border-red-500/50 text-red-300"),children:_.text}),(0,a.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,a.jsxs)("div",{className:"w-full md:w-1/3",children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Amount to Grant"}),(0,a.jsx)("input",{type:"number",min:"1",max:"10000",value:v,onChange:e=>g(Math.max(1,parseInt(e.target.value)||0)),className:"w-full cosmic-input"})]}),(0,a.jsxs)("div",{className:"flex-1 flex items-end",children:[(0,a.jsx)("button",{onClick:A,disabled:w||v<=0,className:"btn-gradient py-2 px-6 disabled:opacity-50",children:w?"Processing...":"Grant Tokens"}),(0,a.jsx)("button",{onClick:()=>{N(null),P(null)},className:"btn-outline py-2 px-6 ml-2",children:"Cancel"})]})]})]}),(0,a.jsxs)("div",{className:"cosmic-card border border-space-cyan/30 p-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold mb-6",children:"Users"}),u?(0,a.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,a.jsx)("div",{className:"animate-spin w-8 h-8 border-4 border-space-cyan border-t-transparent rounded-full"})}):0===t.length?(0,a.jsxs)("div",{className:"text-center py-8 text-cosmic-text-secondary",children:["No users found. ",x&&"Try a different search term."]}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full min-w-full",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"border-b border-space-blue/30",children:[(0,a.jsx)("th",{className:"text-left py-3 px-4 font-medium",children:"User"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 font-medium",children:"Email"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 font-medium",children:"Tokens"}),(0,a.jsx)("th",{className:"text-right py-3 px-4 font-medium",children:"Actions"})]})}),(0,a.jsx)("tbody",{children:t.map(e=>(0,a.jsxs)("tr",{className:"border-b border-space-blue/20 hover:bg-space-blue/10",children:[(0,a.jsx)("td",{className:"py-3 px-4",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full overflow-hidden bg-space-dark mr-3",children:(0,a.jsx)("img",{src:e.photoURL||"/default-avatar.png",alt:e.displayName||"User",className:"w-full h-full object-cover"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:e.displayName||"User"}),e.username&&(0,a.jsxs)("div",{className:"text-xs text-cosmic-text-secondary",children:["@",e.username]})]})]})}),(0,a.jsx)("td",{className:"py-3 px-4 text-cosmic-text-secondary",children:e.email}),(0,a.jsx)("td",{className:"py-3 px-4 text-space-gold font-medium",children:e.cosmicTokens||0}),(0,a.jsx)("td",{className:"py-3 px-4 text-right",children:(0,a.jsx)("button",{onClick:()=>{N(e),P(null)},className:"btn-gradient-secondary text-sm py-1 px-3",children:"Grant Tokens"})})]},e.id))})]})})]})]})})]})}},4054:(e,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),!function(e,s){for(var t in s)Object.defineProperty(e,t,{enumerable:!0,get:s[t]})}(s,{bindSnapshot:function(){return l},createAsyncLocalStorage:function(){return r},createSnapshot:function(){return i}});let t=Object.defineProperty(Error("Invariant: AsyncLocalStorage accessed in runtime where it is not available"),"__NEXT_ERROR_CODE",{value:"E504",enumerable:!1,configurable:!0});class a{disable(){throw t}getStore(){}run(){throw t}exit(){throw t}enterWith(){throw t}static bind(e){return e}}let n="undefined"!=typeof globalThis&&globalThis.AsyncLocalStorage;function r(){return n?new n:new a}function l(e){return n?n.bind(e):a.bind(e)}function i(){return n?n.snapshot():function(e,...s){return e(...s)}}},5028:(e,s,t)=>{"use strict";t.d(s,{default:()=>n.a});var a=t(6645),n=t.n(a)},5695:(e,s,t)=>{"use strict";var a=t(8999);t.o(a,"usePathname")&&t.d(s,{usePathname:function(){return a.usePathname}}),t.o(a,"useRouter")&&t.d(s,{useRouter:function(){return a.useRouter}})},5744:(e,s,t)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"workAsyncStorage",{enumerable:!0,get:function(){return a.workAsyncStorageInstance}});let a=t(7828)},5928:(e,s,t)=>{"use strict";t.d(s,{A:()=>d,O:()=>o});var a=t(5155),n=t(2115),r=t(3004),l=t(6104),i=t(5317);let c=(0,n.createContext)(null);function d(){let e=(0,n.useContext)(c);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}function o(e){let{children:s}=e,[t,d]=(0,n.useState)(null),[o,u]=(0,n.useState)(!0);(0,n.useEffect)(()=>{let e=(0,r.hg)(l.j2,e=>{d(e),u(!1)});return(0,r.Q4)(l.j2).then(e=>{(null==e?void 0:e.user)&&d(e.user)}).catch(e=>{}),e},[]);let m=async(e,s,t)=>{let a=await (0,r.eJ)(l.j2,e,s),n=a.user;return t&&n&&(await (0,r.r7)(n,{displayName:t}),await (0,i.BN)((0,i.H9)(l.db,"userProfiles",n.uid),{email:n.email,username:t,displayName:t,createdAt:(0,i.O5)(),hasSetUsername:!0})),a},x=async()=>{try{l.hJ.setCustomParameters({prompt:"select_account"});let s=await (0,r.df)(l.j2,l.hJ,r.hk),t=s.user;if(t){var e;await (0,i.BN)((0,i.H9)(l.db,"userProfiles",t.uid),{email:t.email,displayName:t.displayName||(null===(e=t.email)||void 0===e?void 0:e.split("@")[0])||"User",photoURL:t.photoURL,createdAt:(0,i.O5)(),lastLogin:(0,i.O5)(),hasSetUsername:!1},{merge:!0})}return s}catch(e){if("auth/popup-blocked"===e.code||"auth/popup-closed-by-user"===e.code||"auth/cancelled-popup-request"===e.code){await (0,r.$2)(l.j2,l.hJ);return}throw e}};return(0,a.jsx)(c.Provider,{value:{user:t,loading:o,signUp:m,signIn:(e,s)=>(0,r.x9)(l.j2,e,s),signInWithGoogle:x,logout:()=>(0,r.CI)(l.j2)},children:s})}},6104:(e,s,t)=>{"use strict";let a;t.d(s,{IG:()=>o,db:()=>d,hJ:()=>u,j2:()=>c});var n=t(3915),r=t(3004),l=t(5317),i=t(858);let c=null,d=null,o=null,u=null;(a=(0,n.Dk)().length?(0,n.Dk)()[0]:(0,n.Wp)({apiKey:"AIzaSyCQf_QXzyZkyRxsbo91PJmdwjEn3lVfDTo",authDomain:"cosmicteams-bbf29.firebaseapp.com",projectId:"cosmicteams-bbf29",storageBucket:"cosmicteams-bbf29.appspot.com",messagingSenderId:"807144888137",appId:"1:807144888137:web:2621a3ac917d9675d6ec98"}))&&(c=(0,r.xI)(a),d=(0,l.aU)(a),o=(0,i.c7)(a),u=new r.HF)},6645:(e,s,t)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"default",{enumerable:!0,get:function(){return n}});let a=t(8229)._(t(7357));function n(e,s){var t;let n={};"function"==typeof e&&(n.loader=e);let r={...n,...s};return(0,a.default)({...r,modules:null==(t=r.loadableGenerated)?void 0:t.modules})}("function"==typeof s.default||"object"==typeof s.default&&null!==s.default)&&void 0===s.default.__esModule&&(Object.defineProperty(s.default,"__esModule",{value:!0}),Object.assign(s.default,s),e.exports=s.default)},7357:(e,s,t)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"default",{enumerable:!0,get:function(){return c}});let a=t(5155),n=t(2115),r=t(2146);function l(e){return{default:e&&"default"in e?e.default:e}}t(255);let i={loader:()=>Promise.resolve(l(()=>null)),loading:null,ssr:!0},c=function(e){let s={...i,...e},t=(0,n.lazy)(()=>s.loader().then(l)),c=s.loading;function d(e){let l=c?(0,a.jsx)(c,{isLoading:!0,pastDelay:!0,error:null}):null,i=!s.ssr||!!s.loading,d=i?n.Suspense:n.Fragment,o=s.ssr?(0,a.jsxs)(a.Fragment,{children:[null,(0,a.jsx)(t,{...e})]}):(0,a.jsx)(r.BailoutToCSR,{reason:"next/dynamic",children:(0,a.jsx)(t,{...e})});return(0,a.jsx)(d,{...i?{fallback:l}:{},children:o})}return d.displayName="LoadableComponent",d}},7828:(e,s,t)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"workAsyncStorageInstance",{enumerable:!0,get:function(){return a}});let a=(0,t(4054).createAsyncLocalStorage)()}},e=>{var s=s=>e(e.s=s);e.O(0,[611,416,835,441,684,358],()=>s(697)),_N_E=e.O()}]);