(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[244],{255:(e,t,a)=>{"use strict";function r(e){let{moduleIds:t}=e;return null}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadChunks",{enumerable:!0,get:function(){return r}}),a(5155),a(7650),a(5744),a(589)},1584:(e,t,a)=>{"use strict";a.d(t,{A:()=>i});var r=a(5155);let n=(0,a(5028).default)(()=>Promise.all([a.e(766),a.e(874),a.e(615)]).then(a.bind(a,4615)),{loadableGenerated:{webpack:()=>[4615]},ssr:!1});function i(){return(0,r.jsx)(n,{})}},2146:(e,t,a)=>{"use strict";function r(e){let{reason:t,children:a}=e;return a}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return r}}),a(5262)},3379:(e,t,a)=>{Promise.resolve().then(a.bind(a,5886))},4054:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var a in t)Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}(t,{bindSnapshot:function(){return s},createAsyncLocalStorage:function(){return i},createSnapshot:function(){return l}});let a=Object.defineProperty(Error("Invariant: AsyncLocalStorage accessed in runtime where it is not available"),"__NEXT_ERROR_CODE",{value:"E504",enumerable:!1,configurable:!0});class r{disable(){throw a}getStore(){}run(){throw a}exit(){throw a}enterWith(){throw a}static bind(e){return e}}let n="undefined"!=typeof globalThis&&globalThis.AsyncLocalStorage;function i(){return n?new n:new r}function s(e){return n?n.bind(e):r.bind(e)}function l(){return n?n.snapshot():function(e,...t){return e(...t)}}},5028:(e,t,a)=>{"use strict";a.d(t,{default:()=>n.a});var r=a(6645),n=a.n(r)},5695:(e,t,a)=>{"use strict";var r=a(8999);a.o(r,"usePathname")&&a.d(t,{usePathname:function(){return r.usePathname}}),a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}})},5744:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"workAsyncStorage",{enumerable:!0,get:function(){return r.workAsyncStorageInstance}});let r=a(7828)},5886:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>f});var r=a(5155),n=a(2115),i=a(5695),s=a(5928),l=a(5317),o=a(6104),d=a(1584),c=a(6874),u=a.n(c),m=a(6766);function f(){let e=(0,i.useRouter)(),{user:t}=(0,s.A)(),[a,c]=(0,n.useState)([]),[f,p]=(0,n.useState)(!0),[h,b]=(0,n.useState)(null),[x,y]=(0,n.useState)(null);(0,n.useEffect)(()=>{if(!t){e.push("/login");return}(async()=>{try{p(!0);let e=(0,l.P)((0,l.rJ)(o.db,"invitations"),(0,l._M)("invitedEmail","==",t.email),(0,l._M)("status","==","pending")),a=await (0,l.GG)(e),r=[];for(let e of a.docs){let t=e.data(),a=await (0,l.x7)((0,l.H9)(o.db,"teams",t.teamId));if(a.exists()){let n=a.data();r.push({id:e.id,teamId:t.teamId,teamName:n.name||"Unknown Team",teamLogo:n.logo,invitedBy:t.invitedBy,invitedByUsername:t.invitedByUsername||t.invitedBy.split("@")[0],status:t.status,createdAt:t.createdAt})}}r.sort((e,t)=>e.createdAt&&t.createdAt?t.createdAt.seconds-e.createdAt.seconds:0),c(r)}catch(e){b("Failed to load your invitations. Please try again later.")}finally{p(!1)}})()},[t,e]);let g=async e=>{if(t){y(e.id);try{let r=(0,l.H9)(o.db,"teams",e.teamId),n=await (0,l.x7)(r);if(!n.exists())throw Error("Team no longer exists");await (0,l.mZ)(r,{members:(0,l.hq)(t.email),updatedAt:(0,l.O5)()});let i=(0,l.H9)(o.db,"invitations",e.id);await (0,l.mZ)(i,{status:"accepted",respondedAt:(0,l.O5)()}),await (0,l.gS)((0,l.rJ)(o.db,"notifications"),{userId:n.data().createdBy,type:"invitation_accepted",message:"".concat(t.displayName||t.email," has accepted your invitation to join ").concat(e.teamName),teamId:e.teamId,teamName:e.teamName,createdAt:(0,l.O5)(),read:!1}),c(a.filter(t=>t.id!==e.id))}catch(e){b("Failed to accept invitation. Please try again.")}finally{y(null)}}},v=async e=>{if(t){y(e.id);try{let r=(0,l.H9)(o.db,"invitations",e.id);await (0,l.mZ)(r,{status:"declined",respondedAt:(0,l.O5)()}),await (0,l.gS)((0,l.rJ)(o.db,"notifications"),{userId:e.invitedBy,type:"invitation_declined",message:"".concat(t.displayName||t.email," has declined your invitation to join ").concat(e.teamName),teamId:e.teamId,teamName:e.teamName,createdAt:(0,l.O5)(),read:!1}),c(a.filter(t=>t.id!==e.id))}catch(e){b("Failed to decline invitation. Please try again.")}finally{y(null)}}},j=e=>e?(e.toDate?e.toDate():new Date(e)).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}):"Unknown date",w=e=>{let t=e.split(" "),a="";return 1===t.length?t[0].substring(0,2).toUpperCase():t.slice(0,2).map(e=>e.charAt(0).toUpperCase()).join("")};return(0,r.jsxs)("main",{className:"min-h-screen flex flex-col",children:[(0,r.jsx)(d.A,{}),(0,r.jsx)("div",{className:"container mx-auto px-4 py-8 flex-1 bg-gradient-to-b from-slate-900 to-slate-800",children:(0,r.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-8 p-6 bg-slate-800/80 rounded-lg shadow-xl",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-purple-500",children:"Mail"}),(0,r.jsx)("div",{className:"flex space-x-4",children:(0,r.jsx)(u(),{href:"/",className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors",children:"Return Home"})})]}),h&&(0,r.jsx)("div",{className:"mb-6 p-4 bg-red-900/50 text-red-200 rounded-lg border border-red-700",children:h}),(0,r.jsxs)("div",{className:"bg-white/5 rounded-lg backdrop-blur-sm shadow-xl mb-8 overflow-hidden",children:[(0,r.jsx)("div",{className:"p-6 border-b border-white/10",children:(0,r.jsx)("h2",{className:"text-xl font-semibold text-transparent bg-clip-text bg-gradient-to-r from-blue-300 to-purple-400",children:"Team Invitations"})}),f?(0,r.jsx)("div",{className:"flex justify-center py-10",children:(0,r.jsx)("div",{className:"w-10 h-10 border-t-2 border-b-2 border-blue-500 rounded-full animate-spin"})}):0===a.length?(0,r.jsx)("div",{className:"p-6 text-center text-white/70",children:(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center py-10",children:[(0,r.jsx)("div",{className:"w-16 h-16 text-3xl mb-4 opacity-60",children:"\uD83D\uDCEA"}),(0,r.jsx)("p",{className:"text-lg",children:"No pending invitations"}),(0,r.jsx)("p",{className:"text-sm text-white/50 mt-2",children:"When you receive team invitations, they will appear here"})]})}):(0,r.jsx)("div",{className:"divide-y divide-white/10",children:a.map(e=>(0,r.jsx)("div",{className:"p-6 hover:bg-white/5 transition-colors",children:(0,r.jsxs)("div",{className:"flex items-start md:items-center flex-col md:flex-row gap-4",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:e.teamLogo?(0,r.jsx)("div",{className:"w-14 h-14 rounded-full overflow-hidden border-2 border-purple-500/50",children:(0,r.jsx)(m.default,{src:e.teamLogo,alt:e.teamName,width:56,height:56,className:"object-cover"})}):(0,r.jsx)("div",{className:"w-14 h-14 rounded-full flex items-center justify-center bg-gradient-to-br from-blue-600 to-purple-700 text-white font-bold text-xl",children:w(e.teamName)})}),(0,r.jsxs)("div",{className:"flex-grow",children:[(0,r.jsxs)("h3",{className:"text-lg font-medium text-white",children:["Invitation to join ",(0,r.jsx)("span",{className:"font-bold",children:e.teamName})]}),(0,r.jsxs)("p",{className:"text-white/70 text-sm mb-1",children:["Invited by ",(0,r.jsx)("span",{className:"text-purple-400",children:e.invitedByUsername})]}),(0,r.jsx)("p",{className:"text-white/50 text-xs",children:j(e.createdAt)})]}),(0,r.jsxs)("div",{className:"flex gap-3 mt-4 md:mt-0",children:[(0,r.jsxs)("button",{onClick:()=>g(e),disabled:x===e.id,className:"px-4 py-2 bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white rounded-lg transition-all transform hover:scale-105 disabled:opacity-50 disabled:transform-none flex items-center",children:[x===e.id?(0,r.jsx)("span",{className:"inline-block h-4 w-4 animate-spin rounded-full border-2 border-solid border-current border-r-transparent mr-2"}):null,"Accept"]}),(0,r.jsx)("button",{onClick:()=>v(e),disabled:x===e.id,className:"px-4 py-2 bg-transparent border border-red-500/50 text-red-400 hover:bg-red-500/20 rounded-lg transition-all",children:"Decline"})]})]})},e.id))})]})]})})]})}},5928:(e,t,a)=>{"use strict";a.d(t,{A:()=>d,O:()=>c});var r=a(5155),n=a(2115),i=a(6203),s=a(6104),l=a(5317);let o=(0,n.createContext)(null);function d(){let e=(0,n.useContext)(o);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}function c(e){let{children:t}=e,[a,d]=(0,n.useState)(null),[c,u]=(0,n.useState)(!0);(0,n.useEffect)(()=>{let e=(0,i.hg)(s.j2,e=>{d(e),u(!1)});return(0,i.Q4)(s.j2).then(e=>{(null==e?void 0:e.user)&&d(e.user)}).catch(e=>{}),e},[]);let m=async(e,t,a)=>{let r=await (0,i.eJ)(s.j2,e,t),n=r.user;return a&&n&&(await (0,i.r7)(n,{displayName:a}),await (0,l.BN)((0,l.H9)(s.db,"userProfiles",n.uid),{email:n.email,username:a,displayName:a,createdAt:(0,l.O5)(),hasSetUsername:!0})),r},f=async()=>{try{s.hJ.setCustomParameters({prompt:"select_account"});let t=await (0,i.df)(s.j2,s.hJ,i.hk),a=t.user;if(a){var e;await (0,l.BN)((0,l.H9)(s.db,"userProfiles",a.uid),{email:a.email,displayName:a.displayName||(null===(e=a.email)||void 0===e?void 0:e.split("@")[0])||"User",photoURL:a.photoURL,createdAt:(0,l.O5)(),lastLogin:(0,l.O5)(),hasSetUsername:!1},{merge:!0})}return t}catch(e){if("auth/popup-blocked"===e.code||"auth/popup-closed-by-user"===e.code||"auth/cancelled-popup-request"===e.code){await (0,i.$2)(s.j2,s.hJ);return}throw e}};return(0,r.jsx)(o.Provider,{value:{user:a,loading:c,signUp:m,signIn:(e,t)=>(0,i.x9)(s.j2,e,t),signInWithGoogle:f,logout:()=>(0,i.CI)(s.j2)},children:t})}},6104:(e,t,a)=>{"use strict";let r;a.d(t,{IG:()=>c,db:()=>d,hJ:()=>u,j2:()=>o});var n=a(3915),i=a(6203),s=a(5317),l=a(858);let o=null,d=null,c=null,u=null;(r=(0,n.Dk)().length?(0,n.Dk)()[0]:(0,n.Wp)({apiKey:"AIzaSyCQf_QXzyZkyRxsbo91PJmdwjEn3lVfDTo",authDomain:"cosmicteams-bbf29.firebaseapp.com",projectId:"cosmicteams-bbf29",storageBucket:"cosmicteams-bbf29.appspot.com",messagingSenderId:"807144888137",appId:"1:807144888137:web:2621a3ac917d9675d6ec98"}))&&(o=(0,i.xI)(r),d=(0,s.aU)(r),c=(0,l.c7)(r),u=new i.HF)},6645:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return n}});let r=a(8229)._(a(7357));function n(e,t){var a;let n={};"function"==typeof e&&(n.loader=e);let i={...n,...t};return(0,r.default)({...i,modules:null==(a=i.loadableGenerated)?void 0:a.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},7357:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return o}});let r=a(5155),n=a(2115),i=a(2146);function s(e){return{default:e&&"default"in e?e.default:e}}a(255);let l={loader:()=>Promise.resolve(s(()=>null)),loading:null,ssr:!0},o=function(e){let t={...l,...e},a=(0,n.lazy)(()=>t.loader().then(s)),o=t.loading;function d(e){let s=o?(0,r.jsx)(o,{isLoading:!0,pastDelay:!0,error:null}):null,l=!t.ssr||!!t.loading,d=l?n.Suspense:n.Fragment,c=t.ssr?(0,r.jsxs)(r.Fragment,{children:[null,(0,r.jsx)(a,{...e})]}):(0,r.jsx)(i.BailoutToCSR,{reason:"next/dynamic",children:(0,r.jsx)(a,{...e})});return(0,r.jsx)(d,{...l?{fallback:s}:{},children:c})}return d.displayName="LoadableComponent",d}},7828:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"workAsyncStorageInstance",{enumerable:!0,get:function(){return r}});let r=(0,a(4054).createAsyncLocalStorage)()}},e=>{var t=t=>e(e.s=t);e.O(0,[611,794,288,766,874,441,684,358],()=>t(3379)),_N_E=e.O()}]);