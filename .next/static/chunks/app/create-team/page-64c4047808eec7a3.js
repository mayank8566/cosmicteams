(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[999],{255:(e,t,a)=>{"use strict";function s(e){let{moduleIds:t}=e;return null}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadChunks",{enumerable:!0,get:function(){return s}}),a(5155),a(7650),a(5744),a(589)},1584:(e,t,a)=>{"use strict";a.d(t,{A:()=>l});var s=a(5155);let r=(0,a(5028).default)(()=>Promise.all([a.e(766),a.e(874),a.e(615)]).then(a.bind(a,4615)),{loadableGenerated:{webpack:()=>[4615]},ssr:!1});function l(){return(0,s.jsx)(r,{})}},2146:(e,t,a)=>{"use strict";function s(e){let{reason:t,children:a}=e;return a}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return s}}),a(5262)},4054:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var a in t)Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}(t,{bindSnapshot:function(){return i},createAsyncLocalStorage:function(){return l},createSnapshot:function(){return n}});let a=Object.defineProperty(Error("Invariant: AsyncLocalStorage accessed in runtime where it is not available"),"__NEXT_ERROR_CODE",{value:"E504",enumerable:!1,configurable:!0});class s{disable(){throw a}getStore(){}run(){throw a}exit(){throw a}enterWith(){throw a}static bind(e){return e}}let r="undefined"!=typeof globalThis&&globalThis.AsyncLocalStorage;function l(){return r?new r:new s}function i(e){return r?r.bind(e):s.bind(e)}function n(){return r?r.snapshot():function(e,...t){return e(...t)}}},4629:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>d});var s=a(5155),r=a(2115),l=a(5695),i=a(5928),n=a(6493),o=a(6104),c=a(7015),u=a(1584);function d(){let e=(0,l.useRouter)(),{user:t}=(0,i.A)(),{profile:a}=(0,n.x)(),[d,m]=(0,r.useState)(""),[p,f]=(0,r.useState)(""),[h,b]=(0,r.useState)(""),[y,x]=(0,r.useState)(!1),[w,g]=(0,r.useState)(null),[j,v]=(0,r.useState)(null);(0,r.useEffect)(()=>{if(!t){e.push("/login");return}if(a&&!1===a.canCreateTeams){g("You do not have permission to create teams. Please contact an administrator.");return}(async()=>{if(null==t?void 0:t.email)try{let e=(0,c.rJ)(o.db,"teams"),a=(0,c.P)(e,(0,c._M)("createdBy","==",t.email));(await (0,c.GG)(a)).empty||g("You have already created a team. Normal users can only create one team.")}catch(e){}})()},[t,a,e]);let N=async s=>{if(s.preventDefault(),!y){if(!d.trim()){g("Team name is required");return}if(a&&!1===a.canCreateTeams){g("You do not have permission to create teams. Please contact an administrator.");return}if(!o.db){g("Database connection error. Please try again later.");return}if(null==t?void 0:t.email)try{let e=(0,c.rJ)(o.db,"teams"),a=(0,c.P)(e,(0,c._M)("createdBy","==",t.email));if(!(await (0,c.GG)(a)).empty){g("You have already created a team. Normal users can only create one team.");return}}catch(e){g("Error checking team creation privileges. Please try again.");return}try{if(x(!0),g(null),!t||!t.email){g("You must be logged in to create a team"),x(!1);return}let a=h.split(",").map(e=>e.trim()).filter(e=>e);t.email&&!a.includes(t.email)&&a.unshift(t.email);let s={name:d.trim(),description:p.trim(),members:a,createdBy:t.email,createdAt:(0,c.O5)(),updatedAt:(0,c.O5)(),check:!0,check2:!0,points:0,logo:"/default-team-logo.png"},r=await (0,c.gS)((0,c.rJ)(o.db,"teams"),s);if(!(await (0,c.x7)((0,c.H9)(o.db,"teams",r.id))).exists())throw Error("Team was not created successfully");v('Team "'.concat(d,'" created successfully!')),m(""),f(""),b(""),setTimeout(()=>{e.push("/teams/".concat(r.id))},1500)}catch(e){g("Failed to create team. Please try again.")}finally{x(!1)}}};return(0,s.jsxs)("main",{className:"min-h-screen flex flex-col",children:[(0,s.jsx)(u.A,{}),(0,s.jsxs)("div",{className:"min-h-[calc(100vh-80px)] flex flex-col justify-center py-12 px-6 relative overflow-hidden",children:[(0,s.jsxs)("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[(0,s.jsx)("div",{className:"absolute w-72 h-72 rounded-full bg-space-purple/20 blur-3xl -top-20 -left-20 animate-pulse-slow"}),(0,s.jsx)("div",{className:"absolute w-96 h-96 rounded-full bg-space-indigo/20 blur-3xl -bottom-32 -right-32 animate-pulse-slow delay-1000"}),(0,s.jsx)("div",{className:"absolute top-1/4 left-1/4 w-2 h-2 bg-white rounded-full opacity-70 floating twinkle"}),(0,s.jsx)("div",{className:"absolute top-1/3 right-1/4 w-3 h-3 bg-white rounded-full opacity-50 floating twinkle-delay-1"}),(0,s.jsx)("div",{className:"absolute bottom-1/3 left-1/3 w-2 h-2 bg-white rounded-full opacity-60 floating twinkle-delay-2"}),(0,s.jsx)("div",{className:"absolute top-2/3 right-1/3 w-1 h-1 bg-white rounded-full opacity-80 floating"})]}),(0,s.jsxs)("div",{className:"max-w-2xl w-full mx-auto relative z-10",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-8 p-6 cosmic-card border border-space-purple/30 cosmic-shadow-md",children:[(0,s.jsxs)("h1",{className:"text-3xl font-bold font-space",children:["Create ",(0,s.jsx)("span",{className:"gradient-text cosmic-gradient bg-gradient-shift",children:"Cosmic Team"})]}),(0,s.jsx)("button",{onClick:()=>e.push("/dashboard"),className:"btn-gradient-secondary btn-press btn-shine",children:(0,s.jsx)("span",{children:"Dashboard"})})]}),w&&(0,s.jsx)("div",{className:"mb-6 p-4 bg-cosmic-error/20 text-cosmic-error rounded-lg border border-cosmic-error/30 cosmic-shadow-sm animate-fade-in-up",children:w}),j&&(0,s.jsx)("div",{className:"mb-6 p-4 bg-cosmic-success/20 text-cosmic-success rounded-lg border border-cosmic-success/30 cosmic-shadow-sm animate-fade-in-up",children:j}),(0,s.jsxs)("form",{onSubmit:N,className:"space-y-6 cosmic-card border border-space-purple/30 p-8 cosmic-shadow-md",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2 text-cosmic-text-secondary",children:"Team Name"}),(0,s.jsx)("input",{type:"text",value:d,onChange:e=>m(e.target.value),className:"cosmic-input focus:cosmic-glow-input w-full",placeholder:"Enter team name",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2 text-cosmic-text-secondary",children:"Description"}),(0,s.jsx)("textarea",{value:p,onChange:e=>f(e.target.value),className:"cosmic-input focus:cosmic-glow-input w-full",rows:4,placeholder:"Describe your team's purpose and goals"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2 text-cosmic-text-secondary",children:"Team Members (comma-separated emails)"}),(0,s.jsx)("textarea",{value:h,onChange:e=>b(e.target.value),className:"cosmic-input focus:cosmic-glow-input w-full",rows:2,placeholder:"member1@example.com, member2@example.com"}),(0,s.jsx)("p",{className:"mt-1 text-sm text-cosmic-text-tertiary",children:"Your email will automatically be added as team creator"})]}),(0,s.jsx)("button",{type:"submit",disabled:y||a&&!1===a.canCreateTeams||!o.db,className:"btn-gradient w-full py-3 btn-pulse btn-press btn-shine btn-ripple disabled:opacity-50 disabled:pointer-events-none",children:y?(0,s.jsxs)("span",{className:"flex items-center justify-center",children:[(0,s.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Creating Team..."]}):"Create Team"})]}),(0,s.jsxs)("div",{className:"mt-8 cosmic-card border border-space-cyan/30 p-6 cosmic-shadow-sm",children:[(0,s.jsx)("h3",{className:"text-lg font-bold mb-3 text-space-cyan",children:"Team Creation Tips"}),(0,s.jsxs)("ul",{className:"space-y-2 text-cosmic-text-secondary",children:[(0,s.jsxs)("li",{className:"flex items-start",children:[(0,s.jsx)("span",{className:"text-space-cyan mr-2",children:"•"}),"Give your team a unique, memorable name that reflects your mission"]}),(0,s.jsxs)("li",{className:"flex items-start",children:[(0,s.jsx)("span",{className:"text-space-cyan mr-2",children:"•"}),"Add a detailed description to help members understand the team's purpose"]}),(0,s.jsxs)("li",{className:"flex items-start",children:[(0,s.jsx)("span",{className:"text-space-cyan mr-2",children:"•"}),"Invite team members you collaborate with frequently"]}),(0,s.jsxs)("li",{className:"flex items-start",children:[(0,s.jsx)("span",{className:"text-space-cyan mr-2",children:"•"}),"Everyone starts with 0 points - complete missions to climb the leaderboard!"]})]})]})]})]})]})}},5028:(e,t,a)=>{"use strict";a.d(t,{default:()=>r.a});var s=a(6645),r=a.n(s)},5695:(e,t,a)=>{"use strict";var s=a(8999);a.o(s,"usePathname")&&a.d(t,{usePathname:function(){return s.usePathname}}),a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}})},5744:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"workAsyncStorage",{enumerable:!0,get:function(){return s.workAsyncStorageInstance}});let s=a(7828)},5928:(e,t,a)=>{"use strict";a.d(t,{A:()=>c,O:()=>u});var s=a(5155),r=a(2115),l=a(3004),i=a(6104),n=a(5317);let o=(0,r.createContext)(null);function c(){let e=(0,r.useContext)(o);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}function u(e){let{children:t}=e,[a,c]=(0,r.useState)(null),[u,d]=(0,r.useState)(!0);(0,r.useEffect)(()=>{let e=(0,l.hg)(i.j2,e=>{c(e),d(!1)});return(0,l.Q4)(i.j2).then(e=>{(null==e?void 0:e.user)&&c(e.user)}).catch(e=>{}),e},[]);let m=async(e,t,a)=>{let s=await (0,l.eJ)(i.j2,e,t),r=s.user;return a&&r&&(await (0,l.r7)(r,{displayName:a}),await (0,n.BN)((0,n.H9)(i.db,"userProfiles",r.uid),{email:r.email,username:a,displayName:a,createdAt:(0,n.O5)(),hasSetUsername:!0})),s},p=async()=>{try{i.hJ.setCustomParameters({prompt:"select_account"});let t=await (0,l.df)(i.j2,i.hJ,l.hk),a=t.user;if(a){var e;await (0,n.BN)((0,n.H9)(i.db,"userProfiles",a.uid),{email:a.email,displayName:a.displayName||(null===(e=a.email)||void 0===e?void 0:e.split("@")[0])||"User",photoURL:a.photoURL,createdAt:(0,n.O5)(),lastLogin:(0,n.O5)(),hasSetUsername:!1},{merge:!0})}return t}catch(e){if("auth/popup-blocked"===e.code||"auth/popup-closed-by-user"===e.code||"auth/cancelled-popup-request"===e.code){await (0,l.$2)(i.j2,i.hJ);return}throw e}};return(0,s.jsx)(o.Provider,{value:{user:a,loading:u,signUp:m,signIn:(e,t)=>(0,l.x9)(i.j2,e,t),signInWithGoogle:p,logout:()=>(0,l.CI)(i.j2)},children:t})}},6104:(e,t,a)=>{"use strict";let s;a.d(t,{IG:()=>u,db:()=>c,hJ:()=>d,j2:()=>o});var r=a(3915),l=a(3004),i=a(5317),n=a(858);let o=null,c=null,u=null,d=null;(s=(0,r.Dk)().length?(0,r.Dk)()[0]:(0,r.Wp)({apiKey:"AIzaSyCQf_QXzyZkyRxsbo91PJmdwjEn3lVfDTo",authDomain:"cosmicteams-bbf29.firebaseapp.com",projectId:"cosmicteams-bbf29",storageBucket:"cosmicteams-bbf29.appspot.com",messagingSenderId:"807144888137",appId:"1:807144888137:web:2621a3ac917d9675d6ec98"}))&&(o=(0,l.xI)(s),c=(0,i.aU)(s),u=(0,n.c7)(s),d=new l.HF)},6493:(e,t,a)=>{"use strict";a.d(t,{H:()=>m,x:()=>d});var s=a(5155),r=a(2115),l=a(5317),i=a(3004),n=a(858),o=a(6104),c=a(5928);let u=(0,r.createContext)(null);function d(){let e=(0,r.useContext)(u);if(!e)throw Error("useProfile must be used within a ProfileProvider");return e}function m(e){let{children:t}=e,{user:a}=(0,c.A)(),[d,m]=(0,r.useState)(null),[p,f]=(0,r.useState)(!0),[h,b]=(0,r.useState)(!1),[y,x]=(0,r.useState)(null);(0,r.useEffect)(()=>{!async function(){if(!a){m(null),f(!1);return}f(!0);try{let e={displayName:a.displayName||"",photoURL:a.photoURL||"",email:a.email||"",username:a.email?a.email.split("@")[0]:"",profileMusic:null,musicType:null,gameTiers:{"neth-op":"LT1",axe:"LT1",smp:"LT1",cpvp:"LT1",sword:"LT1",uhc:"LT1"},canCreateTeams:!0,lastUpdated:Date.now(),createdAt:Date.now(),cosmicTokens:100,spinnerUsed:0,lastSpinTime:0};if(a.uid&&o.db){let t=(0,l.H9)(o.db,"userProfiles",a.uid),s=await (0,l.x7)(t);s.exists()?m({...e,...s.data()}):(await (0,l.BN)(t,{...e,createdAt:Date.now(),lastUpdated:Date.now()}),m(e))}else m(e)}catch(e){x("Failed to load profile data"),a&&m({displayName:a.displayName||"",photoURL:a.photoURL||"",email:a.email||"",username:a.email?a.email.split("@")[0]:"",profileMusic:null,musicType:null})}finally{f(!1)}}()},[a,o.db]);let w=async e=>{if(a){b(!0),x(null);try{if(e.displayName||e.photoURL){let t={};e.displayName&&(t.displayName=e.displayName),e.photoURL&&(t.photoURL=e.photoURL),await (0,i.r7)(a,t)}if(void 0!==e.cosmicTokens){if(e.cosmicTokens<0)throw Error("Token amount cannot be negative");e.cosmicTokens=Number(e.cosmicTokens)}if(a.uid&&o.db){let t=(0,l.H9)(o.db,"userProfiles",a.uid),s={...e,lastUpdated:Date.now()};await (0,l.mZ)(t,s);let r=(await (0,l.x7)(t)).data();m(e=>e?{...e,...r}:null)}else m(t=>t?{...t,...e}:null)}catch(e){throw x("Failed to update profile"),e}finally{b(!1)}}},g=async e=>{if(!a)throw Error("User not authenticated");b(!0),x(null);try{if(e.size>2097152)throw Error("Image file is too large. Please select a file under 2MB.");if(!e.type.startsWith("image/"))throw Error("Please select a valid image file (JPG, PNG, etc.)");let t=(0,n.KR)(o.IG,"profile-images/".concat(a.uid,"/").concat(Date.now(),"-").concat(e.name));if((null==d?void 0:d.photoURL)&&d.photoURL.includes("firebasestorage.googleapis.com"))try{let e=(0,n.KR)(o.IG,d.photoURL);await (0,n.XR)(e)}catch(e){}await (0,n.D)(t,e);let s=await (0,n.qk)(t);return await w({photoURL:s}),s}catch(e){throw x(e instanceof Error?e.message:"Failed to upload profile image"),e}finally{b(!1)}},j=async e=>{if(a){b(!0),x(null);try{a.uid&&await w({gameTiers:e})}catch(e){throw x("Failed to update game tiers"),e}finally{b(!1)}}},v=async(e,t)=>{if(!a||!a.email)throw Error("User not authenticated or email not available");b(!0),x(null);try{let s=i.IX.credential(a.email,e);await (0,i.kZ)(a,s),await (0,i.f3)(a,t)}catch(e){throw"auth/wrong-password"===e.code?x("Current password is incorrect"):x("Failed to change password"),e}finally{b(!1)}},N=async(e,t)=>{if(!a||!a.email)throw Error("User not authenticated or email not available");b(!0),x(null);try{let s=i.IX.credential(a.email,e);await (0,i.kZ)(a,s),await (0,i.Ww)(a,t),await w({email:t})}catch(e){throw"auth/wrong-password"===e.code?x("Current password is incorrect"):"auth/email-already-in-use"===e.code?x("This email is already in use by another account"):x("Failed to change email"),e}finally{b(!1)}};return(0,s.jsx)(u.Provider,{value:{profile:d,loading:p,updating:h,error:y,updateProfileData:w,uploadProfileImage:g,changePassword:v,changeEmail:N,updateAllGameTiers:j},children:t})}},6645:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r}});let s=a(8229)._(a(7357));function r(e,t){var a;let r={};"function"==typeof e&&(r.loader=e);let l={...r,...t};return(0,s.default)({...l,modules:null==(a=l.loadableGenerated)?void 0:a.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},7357:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return o}});let s=a(5155),r=a(2115),l=a(2146);function i(e){return{default:e&&"default"in e?e.default:e}}a(255);let n={loader:()=>Promise.resolve(i(()=>null)),loading:null,ssr:!0},o=function(e){let t={...n,...e},a=(0,r.lazy)(()=>t.loader().then(i)),o=t.loading;function c(e){let i=o?(0,s.jsx)(o,{isLoading:!0,pastDelay:!0,error:null}):null,n=!t.ssr||!!t.loading,c=n?r.Suspense:r.Fragment,u=t.ssr?(0,s.jsxs)(s.Fragment,{children:[null,(0,s.jsx)(a,{...e})]}):(0,s.jsx)(l.BailoutToCSR,{reason:"next/dynamic",children:(0,s.jsx)(a,{...e})});return(0,s.jsx)(c,{...n?{fallback:i}:{},children:u})}return c.displayName="LoadableComponent",c}},7416:(e,t,a)=>{Promise.resolve().then(a.bind(a,4629))},7828:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"workAsyncStorageInstance",{enumerable:!0,get:function(){return s}});let s=(0,a(4054).createAsyncLocalStorage)()}},e=>{var t=t=>e(e.s=t);e.O(0,[611,416,835,441,684,358],()=>t(7416)),_N_E=e.O()}]);