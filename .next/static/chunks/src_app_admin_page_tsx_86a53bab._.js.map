{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/Mayank/Desktop/cosmicteams/src/app/admin/page.tsx"],"sourcesContent":["'use client';\n\nimport { useState, FormEvent, useEffect } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { useAuth } from '@/lib/AuthContext';\nimport { useProfile } from '@/lib/ProfileContext';\nimport { \n  doc, \n  updateDoc, \n  increment, \n  arrayUnion, \n  collection, \n  query, \n  where, \n  getDocs \n} from '@firebase/firestore';\nimport { db } from '@/lib/firebase';\n\nconst ADMIN_CREDENTIALS = {\n  email: 'admin@cosmicteams.com',\n  password: 'admin123'\n};\n\nexport default function AdminPage() {\n  const router = useRouter();\n  const { user } = useAuth();\n  const { profile } = useProfile();\n\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [userEmail, setUserEmail] = useState('');\n  const [isProcessing, setIsProcessing] = useState(false);\n\n  // For token management\n  const [tokenUserEmail, setTokenUserEmail] = useState('');\n  const [tokenAmount, setTokenAmount] = useState<number>(100);\n  const [isGrantingTokens, setIsGrantingTokens] = useState(false);\n  const [tokenError, setTokenError] = useState<string | null>(null);\n  const [tokenSuccess, setTokenSuccess] = useState<string | null>(null);\n\n  // Check if admin is already authenticated using session storage\n  useEffect(() => {\n    const adminAuth = sessionStorage.getItem('adminAuth');\n    if (adminAuth === 'true') {\n      setIsAuthenticated(true);\n    }\n  }, []);\n\n  const handleLogin = (e: FormEvent) => {\n    e.preventDefault();\n    if (\n      email === ADMIN_CREDENTIALS.email && \n      password === ADMIN_CREDENTIALS.password\n    ) {\n      setIsAuthenticated(true);\n      sessionStorage.setItem('adminAuth', 'true');\n      setError(null);\n    } else {\n      setError('Invalid credentials. Please try again.');\n    }\n  };\n\n  const handleGrantAccess = async (e: FormEvent) => {\n    e.preventDefault();\n    if (!userEmail) {\n      setError('Please enter a user email');\n      return;\n    }\n\n    setIsProcessing(true);\n    setError(null);\n\n    try {\n      // Get the user's profile document\n      const docRef = doc(db, 'userProfiles', userEmail);\n      \n      // Update the canCreateTeams field\n      await updateDoc(docRef, {\n        canCreateTeams: true,\n        lastUpdated: Date.now()\n      });\n\n      setUserEmail('');\n      alert('Access granted successfully!');\n    } catch (err) {\n      console.error('Error granting access:', err);\n      setError('Failed to grant access. Please check the email and try again.');\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  const handleGrantTokens = async (e: FormEvent) => {\n    e.preventDefault();\n    if (!tokenUserEmail) {\n      setTokenError('Please enter a user email');\n      return;\n    }\n\n    if (tokenAmount <= 0) {\n      setTokenError('Token amount must be greater than 0');\n      return;\n    }\n\n    setIsGrantingTokens(true);\n    setTokenError(null);\n\n    try {\n      // First, query to find the user profile document by email\n      const userProfilesCollection = collection(db, 'userProfiles');\n      const userEmailQuery = query(\n        userProfilesCollection,\n        where('email', '==', tokenUserEmail)\n      );\n      \n      const querySnapshot = await getDocs(userEmailQuery);\n      \n      if (querySnapshot.empty) {\n        throw new Error('User not found with the provided email');\n      }\n      \n      // Get the document ID (user's UID) from the query result\n      const userDoc = querySnapshot.docs[0];\n      const userUid = userDoc.id;\n      \n      // Now use the correct UID to update the tokens\n      const docRef = doc(db, 'userProfiles', userUid);\n      \n      // Update the cosmicTokens field - increment by the specified amount\n      await updateDoc(docRef, {\n        cosmicTokens: increment(tokenAmount),\n        lastUpdated: Date.now()\n      });\n\n      // Add to user's spin history\n      await updateDoc(docRef, {\n        spinHistory: arrayUnion({\n          time: Date.now(),\n          prize: { type: 'tokens', amount: tokenAmount },\n          type: 'admin-grant'\n        })\n      });\n\n      setTokenSuccess(`Successfully granted ${tokenAmount} tokens to ${tokenUserEmail}!`);\n      setTimeout(() => setTokenSuccess(null), 5000);\n      setTokenUserEmail('');\n      setTokenAmount(100);\n    } catch (err) {\n      console.error('Error granting tokens:', err);\n      if (err instanceof Error) {\n        setTokenError(`Failed to grant tokens: ${err.message}`);\n      } else {\n        setTokenError('Failed to grant tokens. Please check the email and try again.');\n      }\n    } finally {\n      setIsGrantingTokens(false);\n    }\n  };\n\n  if (!isAuthenticated) {\n    return (\n      <div className=\"container mx-auto px-4 py-8 bg-gradient-to-b from-slate-900 to-slate-800 min-h-screen\">\n        <div className=\"max-w-md mx-auto\">\n          <h1 className=\"text-3xl font-bold mb-8 text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-purple-500 text-center\">Admin Login</h1>\n          \n          <form onSubmit={handleLogin} className=\"space-y-6 bg-white/5 p-8 rounded-lg backdrop-blur-sm shadow-xl\">\n            <div>\n              <label className=\"block text-sm font-medium mb-2\">Email</label>\n              <input\n                type=\"email\"\n                value={email}\n                onChange={(e) => setEmail(e.target.value)}\n                className=\"w-full px-4 py-3 rounded-lg border border-gray-700 bg-gray-800/50 focus:ring-2 focus:ring-blue-500 outline-none text-white\"\n                required\n                placeholder=\"admin@cosmicteams.com\"\n              />\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium mb-2\">Password</label>\n              <input\n                type=\"password\"\n                value={password}\n                onChange={(e) => setPassword(e.target.value)}\n                className=\"w-full px-4 py-3 rounded-lg border border-gray-700 bg-gray-800/50 focus:ring-2 focus:ring-blue-500 outline-none text-white\"\n                required\n                placeholder=\"••••••••\"\n              />\n            </div>\n\n            {error && (\n              <div className=\"p-4 bg-red-900/50 text-red-200 rounded-lg border border-red-700\">\n                {error}\n              </div>\n            )}\n\n            <button\n              type=\"submit\"\n              className=\"w-full px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white rounded-lg transition-all transform hover:scale-105\"\n            >\n              Login\n            </button>\n          </form>\n          \n          <div className=\"mt-6 text-center text-gray-400 text-sm\">\n            <p>Use the credentials provided by your administrator</p>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"container mx-auto px-4 py-8 bg-gradient-to-b from-slate-900 to-slate-800 min-h-screen\">\n      <div className=\"max-w-2xl mx-auto\">\n        <div className=\"flex justify-between items-center mb-8 p-6 bg-slate-800/80 rounded-lg shadow-xl\">\n          <h1 className=\"text-3xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-purple-500\">Admin Dashboard</h1>\n          <div className=\"flex space-x-4\">\n            <button\n              onClick={() => {\n                sessionStorage.removeItem('adminAuth');\n                setIsAuthenticated(false);\n              }}\n              className=\"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors\"\n            >\n              Logout\n            </button>\n            <button\n              onClick={() => router.push('/')}\n              className=\"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors\"\n            >\n              Home\n            </button>\n          </div>\n        </div>\n\n        <div className=\"bg-white/5 p-8 rounded-lg backdrop-blur-sm shadow-xl\">\n          <h2 className=\"text-xl font-semibold mb-6 text-transparent bg-clip-text bg-gradient-to-r from-blue-300 to-purple-400\">Grant Team Creation Access</h2>\n          \n          <form onSubmit={handleGrantAccess} className=\"space-y-6\">\n            <div>\n              <label className=\"block text-sm font-medium mb-2\">User Email</label>\n              <input\n                type=\"email\"\n                value={userEmail}\n                onChange={(e) => setUserEmail(e.target.value)}\n                className=\"w-full px-4 py-3 rounded-lg border border-gray-700 bg-gray-800/50 focus:ring-2 focus:ring-blue-500 outline-none text-white\"\n                placeholder=\"user@example.com\"\n                required\n              />\n            </div>\n\n            {error && (\n              <div className=\"p-4 bg-red-900/50 text-red-200 rounded-lg border border-red-700\">\n                {error}\n              </div>\n            )}\n\n            <button\n              type=\"submit\"\n              disabled={isProcessing}\n              className=\"px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white rounded-lg transition-all transform hover:scale-105 disabled:opacity-50 disabled:transform-none\"\n            >\n              {isProcessing ? 'Processing...' : 'Grant Access'}\n            </button>\n          </form>\n        </div>\n\n        <div className=\"bg-white/5 p-8 rounded-lg backdrop-blur-sm shadow-xl mt-8\">\n          <h2 className=\"text-xl font-semibold mb-6 text-transparent bg-clip-text bg-gradient-to-r from-blue-300 to-purple-400\">Grant Cosmic Tokens</h2>\n          \n          <form onSubmit={handleGrantTokens} className=\"space-y-6\">\n            <div>\n              <label className=\"block text-sm font-medium mb-2\">User Email</label>\n              <input\n                type=\"email\"\n                value={tokenUserEmail}\n                onChange={(e) => setTokenUserEmail(e.target.value)}\n                className=\"w-full px-4 py-3 rounded-lg border border-gray-700 bg-gray-800/50 focus:ring-2 focus:ring-blue-500 outline-none text-white\"\n                placeholder=\"user@example.com\"\n                required\n              />\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium mb-2\">Token Amount</label>\n              <input\n                type=\"number\"\n                value={tokenAmount}\n                onChange={(e) => setTokenAmount(parseInt(e.target.value))}\n                className=\"w-full px-4 py-3 rounded-lg border border-gray-700 bg-gray-800/50 focus:ring-2 focus:ring-blue-500 outline-none text-white\"\n                required\n              />\n            </div>\n\n            {tokenError && (\n              <div className=\"p-4 bg-red-900/50 text-red-200 rounded-lg border border-red-700\">\n                {tokenError}\n              </div>\n            )}\n\n            {tokenSuccess && (\n              <div className=\"p-4 bg-green-900/50 text-green-200 rounded-lg border border-green-700\">\n                {tokenSuccess}\n              </div>\n            )}\n\n            <button\n              type=\"submit\"\n              disabled={isGrantingTokens}\n              className=\"px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white rounded-lg transition-all transform hover:scale-105 disabled:opacity-50 disabled:transform-none\"\n            >\n              {isGrantingTokens ? 'Processing...' : 'Grant Tokens'}\n            </button>\n          </form>\n        </div>\n      </div>\n    </div>\n  );\n}"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AACA;AACA;AAUA;;;AAhBA;;;;;;;AAkBA,MAAM,oBAAoB;IACxB,OAAO;IACP,UAAU;AACZ;AAEe,SAAS;;IACtB,MAAM,SAAS,CAAA,GAAA,qIAAA,CAAA,YAAS,AAAD;IACvB,MAAM,EAAE,IAAI,EAAE,GAAG,CAAA,GAAA,6HAAA,CAAA,UAAO,AAAD;IACvB,MAAM,EAAE,OAAO,EAAE,GAAG,CAAA,GAAA,gIAAA,CAAA,aAAU,AAAD;IAE7B,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IACnC,MAAM,CAAC,UAAU,YAAY,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IACzC,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IACvD,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAiB;IAClD,MAAM,CAAC,WAAW,aAAa,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAC3C,MAAM,CAAC,cAAc,gBAAgB,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAEjD,uBAAuB;IACvB,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IACrD,MAAM,CAAC,aAAa,eAAe,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAU;IACvD,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IACzD,MAAM,CAAC,YAAY,cAAc,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAiB;IAC5D,MAAM,CAAC,cAAc,gBAAgB,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAiB;IAEhE,gEAAgE;IAChE,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;+BAAE;YACR,MAAM,YAAY,eAAe,OAAO,CAAC;YACzC,IAAI,cAAc,QAAQ;gBACxB,mBAAmB;YACrB;QACF;8BAAG,EAAE;IAEL,MAAM,cAAc,CAAC;QACnB,EAAE,cAAc;QAChB,IACE,UAAU,kBAAkB,KAAK,IACjC,aAAa,kBAAkB,QAAQ,EACvC;YACA,mBAAmB;YACnB,eAAe,OAAO,CAAC,aAAa;YACpC,SAAS;QACX,OAAO;YACL,SAAS;QACX;IACF;IAEA,MAAM,oBAAoB,OAAO;QAC/B,EAAE,cAAc;QAChB,IAAI,CAAC,WAAW;YACd,SAAS;YACT;QACF;QAEA,gBAAgB;QAChB,SAAS;QAET,IAAI;YACF,kCAAkC;YAClC,MAAM,SAAS,CAAA,GAAA,sKAAA,CAAA,MAAG,AAAD,EAAE,yHAAA,CAAA,KAAE,EAAE,gBAAgB;YAEvC,kCAAkC;YAClC,MAAM,CAAA,GAAA,sKAAA,CAAA,YAAS,AAAD,EAAE,QAAQ;gBACtB,gBAAgB;gBAChB,aAAa,KAAK,GAAG;YACvB;YAEA,aAAa;YACb,MAAM;QACR,EAAE,OAAO,KAAK;YACZ,QAAQ,KAAK,CAAC,0BAA0B;YACxC,SAAS;QACX,SAAU;YACR,gBAAgB;QAClB;IACF;IAEA,MAAM,oBAAoB,OAAO;QAC/B,EAAE,cAAc;QAChB,IAAI,CAAC,gBAAgB;YACnB,cAAc;YACd;QACF;QAEA,IAAI,eAAe,GAAG;YACpB,cAAc;YACd;QACF;QAEA,oBAAoB;QACpB,cAAc;QAEd,IAAI;YACF,0DAA0D;YAC1D,MAAM,yBAAyB,CAAA,GAAA,sKAAA,CAAA,aAAU,AAAD,EAAE,yHAAA,CAAA,KAAE,EAAE;YAC9C,MAAM,iBAAiB,CAAA,GAAA,sKAAA,CAAA,QAAK,AAAD,EACzB,wBACA,CAAA,GAAA,sKAAA,CAAA,QAAK,AAAD,EAAE,SAAS,MAAM;YAGvB,MAAM,gBAAgB,MAAM,CAAA,GAAA,sKAAA,CAAA,UAAO,AAAD,EAAE;YAEpC,IAAI,cAAc,KAAK,EAAE;gBACvB,MAAM,IAAI,MAAM;YAClB;YAEA,yDAAyD;YACzD,MAAM,UAAU,cAAc,IAAI,CAAC,EAAE;YACrC,MAAM,UAAU,QAAQ,EAAE;YAE1B,+CAA+C;YAC/C,MAAM,SAAS,CAAA,GAAA,sKAAA,CAAA,MAAG,AAAD,EAAE,yHAAA,CAAA,KAAE,EAAE,gBAAgB;YAEvC,oEAAoE;YACpE,MAAM,CAAA,GAAA,sKAAA,CAAA,YAAS,AAAD,EAAE,QAAQ;gBACtB,cAAc,CAAA,GAAA,sKAAA,CAAA,YAAS,AAAD,EAAE;gBACxB,aAAa,KAAK,GAAG;YACvB;YAEA,6BAA6B;YAC7B,MAAM,CAAA,GAAA,sKAAA,CAAA,YAAS,AAAD,EAAE,QAAQ;gBACtB,aAAa,CAAA,GAAA,sKAAA,CAAA,aAAU,AAAD,EAAE;oBACtB,MAAM,KAAK,GAAG;oBACd,OAAO;wBAAE,MAAM;wBAAU,QAAQ;oBAAY;oBAC7C,MAAM;gBACR;YACF;YAEA,gBAAgB,CAAC,qBAAqB,EAAE,YAAY,WAAW,EAAE,eAAe,CAAC,CAAC;YAClF,WAAW,IAAM,gBAAgB,OAAO;YACxC,kBAAkB;YAClB,eAAe;QACjB,EAAE,OAAO,KAAK;YACZ,QAAQ,KAAK,CAAC,0BAA0B;YACxC,IAAI,eAAe,OAAO;gBACxB,cAAc,CAAC,wBAAwB,EAAE,IAAI,OAAO,EAAE;YACxD,OAAO;gBACL,cAAc;YAChB;QACF,SAAU;YACR,oBAAoB;QACtB;IACF;IAEA,IAAI,CAAC,iBAAiB;QACpB,qBACE,6LAAC;YAAI,WAAU;sBACb,cAAA,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAG,WAAU;kCAAiH;;;;;;kCAE/H,6LAAC;wBAAK,UAAU;wBAAa,WAAU;;0CACrC,6LAAC;;kDACC,6LAAC;wCAAM,WAAU;kDAAiC;;;;;;kDAClD,6LAAC;wCACC,MAAK;wCACL,OAAO;wCACP,UAAU,CAAC,IAAM,SAAS,EAAE,MAAM,CAAC,KAAK;wCACxC,WAAU;wCACV,QAAQ;wCACR,aAAY;;;;;;;;;;;;0CAIhB,6LAAC;;kDACC,6LAAC;wCAAM,WAAU;kDAAiC;;;;;;kDAClD,6LAAC;wCACC,MAAK;wCACL,OAAO;wCACP,UAAU,CAAC,IAAM,YAAY,EAAE,MAAM,CAAC,KAAK;wCAC3C,WAAU;wCACV,QAAQ;wCACR,aAAY;;;;;;;;;;;;4BAIf,uBACC,6LAAC;gCAAI,WAAU;0CACZ;;;;;;0CAIL,6LAAC;gCACC,MAAK;gCACL,WAAU;0CACX;;;;;;;;;;;;kCAKH,6LAAC;wBAAI,WAAU;kCACb,cAAA,6LAAC;sCAAE;;;;;;;;;;;;;;;;;;;;;;IAKb;IAEA,qBACE,6LAAC;QAAI,WAAU;kBACb,cAAA,6LAAC;YAAI,WAAU;;8BACb,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;4BAAG,WAAU;sCAAgG;;;;;;sCAC9G,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;oCACC,SAAS;wCACP,eAAe,UAAU,CAAC;wCAC1B,mBAAmB;oCACrB;oCACA,WAAU;8CACX;;;;;;8CAGD,6LAAC;oCACC,SAAS,IAAM,OAAO,IAAI,CAAC;oCAC3B,WAAU;8CACX;;;;;;;;;;;;;;;;;;8BAML,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;4BAAG,WAAU;sCAAwG;;;;;;sCAEtH,6LAAC;4BAAK,UAAU;4BAAmB,WAAU;;8CAC3C,6LAAC;;sDACC,6LAAC;4CAAM,WAAU;sDAAiC;;;;;;sDAClD,6LAAC;4CACC,MAAK;4CACL,OAAO;4CACP,UAAU,CAAC,IAAM,aAAa,EAAE,MAAM,CAAC,KAAK;4CAC5C,WAAU;4CACV,aAAY;4CACZ,QAAQ;;;;;;;;;;;;gCAIX,uBACC,6LAAC;oCAAI,WAAU;8CACZ;;;;;;8CAIL,6LAAC;oCACC,MAAK;oCACL,UAAU;oCACV,WAAU;8CAET,eAAe,kBAAkB;;;;;;;;;;;;;;;;;;8BAKxC,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;4BAAG,WAAU;sCAAwG;;;;;;sCAEtH,6LAAC;4BAAK,UAAU;4BAAmB,WAAU;;8CAC3C,6LAAC;;sDACC,6LAAC;4CAAM,WAAU;sDAAiC;;;;;;sDAClD,6LAAC;4CACC,MAAK;4CACL,OAAO;4CACP,UAAU,CAAC,IAAM,kBAAkB,EAAE,MAAM,CAAC,KAAK;4CACjD,WAAU;4CACV,aAAY;4CACZ,QAAQ;;;;;;;;;;;;8CAIZ,6LAAC;;sDACC,6LAAC;4CAAM,WAAU;sDAAiC;;;;;;sDAClD,6LAAC;4CACC,MAAK;4CACL,OAAO;4CACP,UAAU,CAAC,IAAM,eAAe,SAAS,EAAE,MAAM,CAAC,KAAK;4CACvD,WAAU;4CACV,QAAQ;;;;;;;;;;;;gCAIX,4BACC,6LAAC;oCAAI,WAAU;8CACZ;;;;;;gCAIJ,8BACC,6LAAC;oCAAI,WAAU;8CACZ;;;;;;8CAIL,6LAAC;oCACC,MAAK;oCACL,UAAU;oCACV,WAAU;8CAET,mBAAmB,kBAAkB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAOpD;GA1SwB;;QACP,qIAAA,CAAA,YAAS;QACP,6HAAA,CAAA,UAAO;QACJ,gIAAA,CAAA,aAAU;;;KAHR","debugId":null}}]
}